<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ReviewScope - ë¶„ì„ ê²°ê³¼</title>
    <!-- CSS ê²½ë¡œëŠ” í”„ë¡œì íŠ¸ ì„¤ì •ì— ë§ê²Œ ìˆ˜ì •í•˜ì„¸ìš” -->
    <link href="/style.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <!-- [1] ì¢Œì¸¡ ë©”ë‰´ -->
    <nav class="left-sidebar">
        <div class="brand">Review<span>Scope</span></div>
        <ul class="menu-list">
            <a href="/" class="menu-item">ğŸ  í™ˆ ëŒ€ì‹œë³´ë“œ</a>
            <li class="menu-item active">ğŸ“Š ì‹¬ì¸µ ë¶„ì„</li>
            <li class="menu-item">âš™ï¸ ì„¤ì •</li>
        </ul>
    </nav>

    <!-- [2] ì¤‘ì•™ ë©”ì¸ ì˜ì—­ -->
    <main class="main-container">
        <!-- ìƒë‹¨ë°” -->
        <header class="top-bar">
            ğŸ” &nbsp; <span th:text="${keyword}">í‚¤ì›Œë“œ</span> ë¶„ì„ ë¦¬í¬íŠ¸
        </header>

        <div class="feed-area">
            
            <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
            <div th:if="${error}" style="background:rgba(255,75,75,0.1); color:#ff4b4b; padding:20px; border-radius:12px; margin-bottom:20px;">
                âš ï¸ <span th:text="${error}">ì—ëŸ¬ ë°œìƒ</span>
            </div>

            <div th:if="${error} == null">
                <!-- 1. ê¸ì •/ë¶€ì • ì°¨íŠ¸ ì¹´ë“œ -->
                <div class="content-card">
                    <h2 style="margin-bottom: 15px; font-size: 18px;">ğŸ˜Š ê¸ì • vs ë¶€ì • ì—¬ë¡  ë¶„ì„</h2>
                    <div class="big-chart-box">
                        <!-- ì°¨íŠ¸ ì˜ì—­ -->
                        <div class="chart-wrapper">
                            <canvas id="chart"></canvas>
                        </div>
                        
                        <!-- ë²”ë¡€ ì˜ì—­ (ë°ì´í„° ì—°ë™) -->
                        <div class="chart-legend">
                            <div class="legend-item">
                                <div class="dot" style="background: var(--accent);"></div>
                                <!-- ê¸ì • ê°œìˆ˜ í‘œì‹œ -->
                                <span>ê¸ì •: <strong th:text="${#lists.size(positives)} + 'ê°œ'">0ê°œ</strong></span>
                            </div>
                            <div class="legend-item">
                                <div class="dot" style="background: var(--accent-red);"></div>
                                <!-- ë¶€ì • ê°œìˆ˜ í‘œì‹œ -->
                                <span>ë¶€ì •: <strong th:text="${#lists.size(negatives)} + 'ê°œ'">0ê°œ</strong></span>
                            </div>
                            <div class="legend-item">
                                <div class="dot" style="background: #A0A0A0;"></div>
                                <!-- ì¤‘ë¦½/ê¸°íƒ€ëŠ” ê³„ì‚° í•„ìš”í•˜ë©´ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë„˜ê²¨ì¤˜ì•¼ í•¨. ì¼ë‹¨ ì „ì²´ì—ì„œ ëº€ ê°’ ë“±ìœ¼ë¡œ ì²˜ë¦¬ ê°€ëŠ¥ -->
                                <span>ì „ì²´ ë¶„ì„: <strong th:text="${totalCount} + 'ê±´'">0ê±´</strong></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. ëŒ€í‘œì ì¸ ë°˜ì‘ (ê¸ì •/ë¶€ì • ë¦¬ìŠ¤íŠ¸) -->
                <div class="content-card">
                    <h3 style="font-size:18px; margin-bottom: 15px;">ğŸ“¢ ì£¼ìš” ë°˜ì‘ ìš”ì•½</h3>
                    
                    <div style="display: flex; gap: 20px;">
                        
                        <!-- ê¸ì • ë¦¬ë·° ë¦¬ìŠ¤íŠ¸ -->
                        <div style="flex: 1; background: rgba(0, 224, 198, 0.05); padding: 15px; border-radius: 8px;">
                            <h4 style="color: var(--accent); margin-bottom: 10px;">ğŸ˜Š ê¸ì •ì  ì˜ê²¬</h4>
                            <ul style="list-style: none; padding: 0;">
                                <li th:each="review : ${positives}" style="margin-bottom: 10px; font-size: 14px;">
                                    <a th:href="${review.link}" target="_blank" style="text-decoration: none; color: inherit;">
                                        <div style="font-weight: bold; margin-bottom: 2px;" th:text="${review.title}">ì œëª©</div>
                                        <div style="font-size: 12px; color: #666;" th:text="${review.summary}">ë‚´ìš©...</div>
                                    </a>
                                </li>
                                <li th:if="${#lists.isEmpty(positives)}" style="color: #999;">ê¸ì • ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤.</li>
                            </ul>
                        </div>

                        <!-- ë¶€ì • ë¦¬ë·° ë¦¬ìŠ¤íŠ¸ -->
                        <div style="flex: 1; background: rgba(255, 75, 75, 0.05); padding: 15px; border-radius: 8px;">
                            <h4 style="color: var(--accent-red); margin-bottom: 10px;">ğŸ˜¡ ë¶€ì •ì  ì˜ê²¬</h4>
                            <ul style="list-style: none; padding: 0;">
                                <li th:each="review : ${negatives}" style="margin-bottom: 10px; font-size: 14px;">
                                    <a th:href="${review.link}" target="_blank" style="text-decoration: none; color: inherit;">
                                        <div style="font-weight: bold; margin-bottom: 2px;" th:text="${review.title}">ì œëª©</div>
                                        <div style="font-size: 12px; color: #666;" th:text="${review.summary}">ë‚´ìš©...</div>
                                    </a>
                                </li>
                                <li th:if="${#lists.isEmpty(negatives)}" style="color: #999;">ë¶€ì • ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤.</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 3. ì›ë³¸ ë°ì´í„° ë¦¬ìŠ¤íŠ¸ (ê¸°ì¡´ ìœ ì§€) -->
                <div class="content-card" style="margin-top: 20px;">
                    <h3 style="font-size:18px; margin-bottom: 10px;">ğŸ“„ ì „ì²´ ìˆ˜ì§‘ ë°ì´í„° (ìµœì‹ ìˆœ)</h3>
                     <!-- recentFiles ëŒ€ì‹  positives + negatives ë“±ì„ í•©ì³ì„œ ë³´ì—¬ì£¼ê±°ë‚˜ ë³„ë„ ë¦¬ìŠ¤íŠ¸ í•„ìš” -->
                     <!-- ì—¬ê¸°ì„œëŠ” ì˜ˆì‹œë¡œ 'ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤' ë©”ì‹œì§€ë§Œ í‘œì‹œí•˜ê±°ë‚˜ ìƒëµ ê°€ëŠ¥ -->
                     <p>ìƒì„¸ ë°ì´í„°ëŠ” <code>data_storage/</code> í´ë”ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                </div>
            </div>

        </div>
    </main>

    <!-- [3] ìš°ì¸¡ ì‚¬ì´ë“œë°” (ê·¸ëŒ€ë¡œ ìœ ì§€) -->
    <aside class="right-sidebar">
        <!-- ... (ê¸°ì¡´ ë‚´ìš© ë™ì¼) ... -->
    </aside>

    <!-- [ìŠ¤í¬ë¦½íŠ¸] ì°¨íŠ¸ ë°ì´í„° ì—°ë™ -->
    <script th:inline="javascript">
        /* Thymeleaf ë³€ìˆ˜ë¥¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ê°€ì ¸ì˜¤ê¸° */
        const positiveCount = [[${#lists.size(positives)}]];
        const negativeCount = [[${#lists.size(negatives)}]];
        // ì¤‘ë¦½ì€ ì „ì²´ì—ì„œ ê¸ì •+ë¶€ì •ì„ ëº€ ê°’ (ê°„ë‹¨ ê³„ì‚°)
        const total = [[${totalCount}]];
        const neutralCount = Math.max(0, total - positiveCount - negativeCount);

        const ctx = document.getElementById('chart').getContext('2d');
        
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['ê¸ì •', 'ë¶€ì •', 'ê¸°íƒ€'],
                datasets: [{
                    data: [positiveCount, negativeCount, neutralCount],
                    backgroundColor: ['#00E0C6', '#FF4B4B', '#A0A0A0'],
                    borderWidth: 0,
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '70%',
                plugins: {
                    legend: { display: false }
                }
            }
        });
    </script>
</body>
</html>

